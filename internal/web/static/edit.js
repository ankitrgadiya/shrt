var dom;(function(g){g.q=function(e){return document.querySelector(e)};g.qa=function(e){return document.querySelectorAll(e)};g.c=function(e){return document.createElement(e)};g.css=function(e,c,a){e.style.setProperty(c,a,"")}})(dom||={});var xhr;
(function(g){var e=function(){function c(a){var m=this;this.xhr=a;this.doneFns=[];this.errorFns=[];a.onload=function(){var n=a.responseText,p=a.status;m.doneFns.forEach(function(q){q(n,p)})};a.onerror=function(){m.errorFns.forEach(function(n){return n()})}}c.prototype.onDone=function(a){this.doneFns.push(a);return this};c.prototype.onError=function(a){this.errorFns.push(a);return this};c.prototype.withHeader=function(a,m){this.xhr.setRequestHeader(a,m);return this};c.prototype.sendJSON=function(a){this.withHeader("Content-Type",
"application/json;charset=utf8");this.xhr.send(JSON.stringify(a));return this};c.prototype.send=function(a){this.xhr.send(a);return this};return c}();g.Req=e;g.create=function(c,a){var m=new XMLHttpRequest;m.open(c,a,!0);return new e(m)};g.get=function(c){return g.create("GET",c)};g.post=function(c){return g.create("POST",c)}})(xhr||={});var go;
(function(g){var e=function(b){return b.substring(1).split("/").slice(1).join("/")},c=function(){var b=r.getBoundingClientRect();dom.css(r,"margin-top",window.innerHeight/3-b.height/2+"px")},a=function(){var b=(k.value||"").trim();b!=u&&(u=b,p(),b?t.classList.add("vis"):t.classList.remove("vis"))},m=function(b){b.preventDefault();b=e(location.pathname);var f=(k.value||"").trim();xhr.post("/api/url/"+b).sendJSON({url:f}).onDone(function(d,l){d=JSON.parse(d);d.ok?(d=d.route)?(l=d.slug||"",d.url&&(history.replaceState({},
null,"/edit/"+l),l=location.origin+"/"+l,h.textContent="",h.classList.remove("fuck"),h.classList.add("link"),d=dom.c("a"),d.setAttribute("href",l),d.textContent=l,h.appendChild(d),l=dom.c("span"),l.classList.add("hnt"),l.textContent=0<=navigator.userAgent.indexOf("Macintosh")?"\u2318-C":"Ctrl-C",h.appendChild(l),dom.css(h,"transform","scaleY(1)"),getSelection().setBaseAndExtent(d,0,d,1))):p():q(d.error)})},n=function(){var b=e(location.pathname);(k.value||"").trim();k.value="";a();if(b)xhr.create("DELETE",
"/api/url/"+b).send().onDone(function(f,d){f=JSON.parse(f);f.ok||q(f.error)})},p=function(){dom.css(h,"transform","scaleY(0)")},q=function(b){h.textContent="";h.classList.remove("link");h.classList.add("fuck");var f=dom.c("span");f.textContent="ERROR: "+b;h.appendChild(f);dom.css(h,"transform","scaleY(1)")},r=dom.q("form"),h=dom.q("#cmp"),t=dom.q("#cls"),k=dom.q("#url"),u;(function(){c();window.addEventListener("resize",c,!1);r.addEventListener("submit",m,!1);k.addEventListener("keyup",a,!1);k.addEventListener("paste",
a,!1);k.addEventListener("change",a,!1);t.addEventListener("click",n,!1);var b=e(location.pathname);if(b)xhr.get("/api/url/"+b).send().onDone(function(f,d){f=JSON.parse(f);200==d&&(k.value=f.route.url||"",k.focus(),a())});else k.focus()})()})(go||={});
